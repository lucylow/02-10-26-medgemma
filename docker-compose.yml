version: "3.8"

services:
  api:
    build: .
    ports:
      - "8000:8000"
    environment:
      - REAL_MODE=${REAL_MODE:-false}
      - EMBED_MODE=${EMBED_MODE:-dummy}
      - FALLBACK_ON_ERROR=${FALLBACK_ON_ERROR:-true}
      - MEDGEMMA_BASE=${MEDGEMMA_BASE:-google/medgemma-2b-it}
      - ADAPTER_PATH=${ADAPTER_PATH:-./adapters/pediscreen_lora}
    volumes:
      - ./data:/app/data

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    # Optional: for Celery/RQ worker queue
